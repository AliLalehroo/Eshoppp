@using Eshop.Application.Utils
@using Eshop.Web.Extensions
@model Eshop.Data.DTOs.OrderDto.OrderDetailDto
@{
    ViewData["Title"] = "جزئیات سفارش";
    var currentStep = (int)Model.OrderState;
    var index = 1;
}

<section class="content">
    <div class="container-fluid">
        <div class="content">
            <div class="row">
                @await Component.InvokeAsync("UserMenu")
                <div class="col-xl-9">
                    <div class="section-title-title">
                        <h2 class="fw-900 h4">
                            سفارش<span class="with-highlight ms-1">@Model.Id</span>
                        </h2>
                        <div class="Dottedsquare"></div>
                    </div>
                    <div class="content">
                        <div class="shoping-proccess rounded-4 border-ui py-5 pb-2 slider-parent">
                            <div class="steps d-flex flex-wrap flex-sm-nowrap justify-content-between padding-top-2x padding-bottom-1x">
                                <div class="step  @(currentStep >= 1 ? "completed" : "")">
                                    <div class="step-icon-wrap">
                                        <div class="step-icon"><i class="bi bi-cart-check fs-2"></i></div>
                                    </div>
                                    <h4 class="step-title">سفارش پرداخت شده</h4>
                                </div>
                                <div class="step @(currentStep >= 2 ? "completed" : "")">
                                    <div class="step-icon-wrap">
                                        <div class="step-icon"><i class="bi bi-gear fs-2"></i></div>
                                    </div>
                                    <h4 class="step-title">پردازش سفارش</h4>
                                </div>
                                <div class="step @(currentStep == 3 ? "completed" : "")">
                                    <div class="step-icon-wrap">
                                        <div class="step-icon"><i class="bi bi-bus-front fs-2"></i></div>
                                    </div>
                                    <h4 class="step-title">تحویل به پست</h4>
                                </div>
                            </div>
                        </div>

                        <div class="orders-item mt-5">
                            <div class="ui-boxs">
                                <div class="ui-box">
                                    <div class="ui-box-item border-ui slider-parent ui-box-white">
                                        <div class="ui-box-item-desc p-0">
                                            <div class="orders">
                                                <div class="">
                                                    <div class="order-item-detail">
                                                        <ul class="nav">
                                                            <li class="nav-item">
                                                                <span class="text-mute">کد پیگیری سفارش</span>
                                                                <strong>@Model.PostTraceCode</strong>
                                                            </li>
                                                            <li class="nav-item">
                                                                <span class="text-mute">تاریخ ثبت سفارش</span>
                                                                <strong>@Model.PaymentRecord.PaymentTime.ToShamsiDate() - @Model.PaymentRecord.PaymentTime.ToString("HH:mm")</strong>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <div class="order-item-detail pt-2">
                                                        <ul class="nav">
                                                            <li class="nav-item">
                                                                <span class="text-mute">تحویل گیرنده</span>
                                                                <strong>@Model.UserName</strong>
                                                            </li>
                                                            <li class="nav-item">
                                                                <span class="text-mute">شماره موبایل </span>
                                                                <strong>@Model.User.MobileNumber</strong>
                                                            </li>
                                                            <li class="nav-item w-100">
                                                            </li>
                                                            <li class="nav-item">
                                                                <span class="text-mute">آدرس</span>
                                                                <span>@ProvinceFinder.GetProvince(Model.DestinationCity) / @Model.DestinationCity ، @Model.Address</span>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <div class="order-item-detail pt-2">
                                                        <ul class="nav">
                                                            <li class="nav-item">
                                                                <span class="text-mute">مبلغ</span>
                                                                <strong>@Model.TotalPrice.ToRial()</strong>
                                                            </li>
                                                            <li class="nav-item">
                                                                <strong>پرداخت اینترنتی</strong>
                                                            </li>
                                                            <li class="nav-item w-100">
                                                            </li>
                                                            <li class="nav-item">
                                                                <span class="text-mute">
                                                                    هزینه ارسال براساس وزن و حجم
                                                                </span>
                                                                <strong>پس کرایه</strong>
                                                            </li>
                                                        </ul>
                                                    </div>
                                                    <div class="order-item-detail">
                                                        <div class="order-detail-products">
                                                            <table class="table table-bordered table-striped">
                                                                @foreach (var item in Model.OrderDetails)
                                                                {
                                                                    <tr>
                                                                        <td>@index</td>
                                                                        <td>
                                                                            <a class="text-dark-blue" asp-area="" asp-controller="Product"
                                                                               asp-action="ProductDetail"
                                                                               asp-route-productId="@item.ProductVariant.ProductId">
                                                                                @item.ProductVariant.Product.Title.LongString20()
                                                                            </a>
                                                                        </td>
                                                                        <td>@item.ProductVariant.ColorTitle</td>
                                                                        <td>@item.Count</td>
                                                                        <td>@item.TotalPrice.ToRial()</td>
                                                                    </tr>
                                                                    index++;
                                                                }
                                                            </table>
                                                        </div>
                                                        <div class="order-item-detail pt-3">
                                                            <a class="btn main-color-one-bg mb-3">
                                                                چاپ
                                                                فاکتور
                                                            </a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>